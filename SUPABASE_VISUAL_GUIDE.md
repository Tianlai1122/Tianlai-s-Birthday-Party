# 🎨 Supabase 可视化步骤指南

这个指南用文字和 ASCII 图表展示每一步。

---

## 🔴 第 1 步：打开 Supabase 官网

**操作：** 在浏览器中访问 https://supabase.com

**你会看到：**

```
╔════════════════════════════════════════════════════════════╗
║                                                            ║
║                    SUPABASE                                ║
║         The Open Source Firebase Alternative              ║
║                                                            ║
║  ┌──────────────────────────────────────────────────────┐ ║
║  │                                                      │ ║
║  │  Build in a weekend, scale to millions              │ ║
║  │                                                      │ ║
║  │  [Sign Up]              [Sign In]                   │ ║
║  │                                                      │ ║
║  └──────────────────────────────────────────────────────┘ ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝
```

**下一步：** 点击右上角的 **"Sign Up"**

---

## 🟠 第 2 步：选择登录方式

**操作：** 点击 "Sign Up" 后，你会看到登录选项

**你会看到：**

```
╔════════════════════════════════════════════════════════════╗
║                                                            ║
║              Sign Up to Supabase                           ║
║                                                            ║
║  ┌──────────────────────────────────────────────────────┐ ║
║  │                                                      │ ║
║  │  [🐙 Continue with GitHub]                          │ ║
║  │                                                      │ ║
║  │  [📧 Continue with Email]                           │ ║
║  │                                                      │ ║
║  │  [🔑 Continue with Google]                          │ ║
║  │                                                      │ ║
║  └──────────────────────────────────────────────────────┘ ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝
```

**下一步：** 点击 **"Continue with GitHub"**

---

## 🟡 第 3 步：GitHub 授权

**操作：** 你会被重定向到 GitHub 登录页面

**你会看到：**

```
╔════════════════════════════════════════════════════════════╗
║                                                            ║
║              GitHub Login                                  ║
║                                                            ║
║  ┌──────────────────────────────────────────────────────┐ ║
║  │                                                      │ ║
║  │  Username or email address:                         │ ║
║  │  [____________________________]                      │ ║
║  │                                                      │ ║
║  │  Password:                                          │ ║
║  │  [____________________________]                      │ ║
║  │                                                      │ ║
║  │  [Sign in]                                          │ ║
║  │                                                      │ ║
║  └──────────────────────────────────────────────────────┘ ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝
```

**操作：**
1. 输入你的 GitHub 用户名
2. 输入你的 GitHub 密码
3. 点击 "Sign in"

**然后你会看到授权请求：**

```
╔════════════════════════════════════════════════════════════╗
║                                                            ║
║  Authorize Supabase                                        ║
║                                                            ║
║  ┌──────────────────────────────────────────────────────┐ ║
║  │                                                      │ ║
║  │  Supabase wants to access your GitHub account       │ ║
║  │                                                      │ ║
║  │  [Authorize supabase]  [Cancel]                     │ ║
║  │                                                      │ ║
║  └──────────────────────────────────────────────────────┘ ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝
```

**下一步：** 点击 **"Authorize supabase"**

---

## 🟢 第 4 步：Supabase Dashboard

**操作：** 授权后，你会进入 Supabase Dashboard

**你会看到：**

```
╔════════════════════════════════════════════════════════════╗
║                                                            ║
║  Welcome to Supabase!                                      ║
║                                                            ║
║  ┌──────────────────────────────────────────────────────┐ ║
║  │                                                      │ ║
║  │  [New Project]  [Import]  [Documentation]           │ ║
║  │                                                      │ ║
║  │  Your Projects:                                     │ ║
║  │  (空的，因为这是第一次)                              │ ║
║  │                                                      │ ║
║  └──────────────────────────────────────────────────────┘ ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝
```

**下一步：** 点击 **"New Project"**

---

## 🔵 第 5 步：创建项目

**操作：** 点击 "New Project" 后，填写项目信息

**你会看到：**

```
╔════════════════════════════════════════════════════════════╗
║                                                            ║
║  Create a new project                                      ║
║                                                            ║
║  ┌──────────────────────────────────────────────────────┐ ║
║  │                                                      │ ║
║  │  Name:                                              │ ║
║  │  [tianlai-birthday-party________________]           │ ║
║  │                                                      │ ║
║  │  Database Password:                                 │ ║
║  │  [MySecurePassword123!@#________________]            │ ║
║  │                                                      │ ║
║  │  Region:                                            │ ║
║  │  [Southeast Asia (Singapore)  ▼]                    │ ║
║  │                                                      │ ║
║  │  Pricing Plan:                                      │ ║
║  │  [Free  ▼]                                          │ ║
║  │                                                      │ ║
║  │  [Create new project]                               │ ║
║  │                                                      │ ║
║  └──────────────────────────────────────────────────────┘ ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝
```

**填写方法：**

| 字段 | 填写内容 | 说明 |
|------|---------|------|
| Name | `tianlai-birthday-party` | 项目名称 |
| Database Password | `MySecurePassword123!@#` | 强密码，记住它 |
| Region | `Southeast Asia (Singapore)` | 离中国最近 |
| Pricing Plan | `Free` | 免费版本 |

**下一步：** 点击 **"Create new project"**

---

## 🟣 第 6 步：等待项目创建

**操作：** 项目正在创建中

**你会看到：**

```
╔════════════════════════════════════════════════════════════╗
║                                                            ║
║  Setting up your project...                                ║
║                                                            ║
║  ┌──────────────────────────────────────────────────────┐ ║
║  │                                                      │ ║
║  │  ⏳ Creating database                               │ ║
║  │  ⏳ Setting up authentication                       │ ║
║  │  ⏳ Initializing storage                            │ ║
║  │  ⏳ Configuring API                                 │ ║
║  │                                                      │ ║
║  │  This may take a minute...                          │ ║
║  │                                                      │ ║
║  └──────────────────────────────────────────────────────┘ ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝
```

**等待 1-2 分钟...**

---

## 🎯 第 7 步：项目创建完成

**操作：** 项目创建完成后，你会进入项目 Dashboard

**你会看到：**

```
╔════════════════════════════════════════════════════════════╗
║                                                            ║
║  tianlai-birthday-party                                    ║
║                                                            ║
║  ┌─────────────────────────────────────────────────────┐  ║
║  │ 左侧菜单：                                          │  ║
║  │ • SQL Editor                                        │  ║
║  │ • Table Editor          ← 点击这个                  │  ║
║  │ • Auth                                              │  ║
║  │ • Storage                                           │  ║
║  │ • Settings                                          │  ║
║  │                                                     │  ║
║  └─────────────────────────────────────────────────────┘  ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝
```

**下一步：** 点击左侧菜单的 **"Table Editor"**

---

## 🎪 第 8 步：创建数据表

**操作：** 在 Table Editor 中创建新表

**你会看到：**

```
╔════════════════════════════════════════════════════════════╗
║                                                            ║
║  Table Editor                                              ║
║                                                            ║
║  ┌──────────────────────────────────────────────────────┐ ║
║  │                                                      │ ║
║  │  [Create a new table]                               │ ║
║  │                                                      │ ║
║  │  Tables:                                            │ ║
║  │  (空的)                                              │ ║
║  │                                                      │ ║
║  └──────────────────────────────────────────────────────┘ ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝
```

**下一步：** 点击 **"Create a new table"**

---

## 🎨 第 9 步：填写表信息

**操作：** 填写表的基本信息

**你会看到：**

```
╔════════════════════════════════════════════════════════════╗
║                                                            ║
║  Create a new table                                        ║
║                                                            ║
║  ┌──────────────────────────────────────────────────────┐ ║
║  │                                                      │ ║
║  │  Name:                                              │ ║
║  │  [party_data________________]                       │ ║
║  │                                                      │ ║
║  │  Description:                                       │ ║
║  │  [Birthday party data storage________________]      │ ║
║  │                                                      │ ║
║  │  ☐ Enable Row Level Security (RLS)                 │ ║
║  │    ↑ 取消勾选这个！                                 │ ║
║  │                                                      │ ║
║  │  [Create table]                                     │ ║
║  │                                                      │ ║
║  └──────────────────────────────────────────────────────┘ ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝
```

**填写方法：**
1. Name: `party_data`
2. Description: `Birthday party data storage`
3. **取消勾选** RLS 复选框
4. 点击 **"Create table"**

---

## 🎭 第 10 步：添加列

**操作：** 为表添加列

**你会看到：**

```
╔════════════════════════════════════════════════════════════╗
║                                                            ║
║  party_data                                                ║
║                                                            ║
║  ┌──────────────────────────────────────────────────────┐ ║
║  │                                                      │ ║
║  │  Columns:                                           │ ║
║  │  • id (uuid) [Primary Key]  [...]                   │ ║
║  │                                                      │ ║
║  │  [Add column]                                       │ ║
║  │                                                      │ ║
║  └──────────────────────────────────────────────────────┘ ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝
```

**操作步骤：**

1. **删除默认的 id 列**
   - 点击 `id` 右边的 `[...]`
   - 选择 "Delete column"
   - 确认删除

2. **添加新的 id 列（text 类型）**
   - 点击 "Add column"
   - Name: `id`
   - Type: `text`
   - Primary Key: ✅ 勾选
   - 点击 "Save"

3. **添加 data 列（jsonb 类型）**
   - 点击 "Add column"
   - Name: `data`
   - Type: `jsonb`
   - 点击 "Save"

4. **添加 updated_at 列（timestamptz 类型）**
   - 点击 "Add column"
   - Name: `updated_at`
   - Type: `timestamptz`
   - Default Value: `now()`
   - 点击 "Save"

**完成后你会看到：**

```
╔════════════════════════════════════════════════════════════╗
║                                                            ║
║  party_data                                                ║
║                                                            ║
║  ┌──────────────────────────────────────────────────────┐ ║
║  │                                                      │ ║
║  │  Columns:                                           │ ║
║  │  • id (text) [Primary Key]                          │ ║
║  │  • data (jsonb)                                     │ ║
║  │  • updated_at (timestamptz)                         │ ║
║  │                                                      │ ║
║  │  [Add column]                                       │ ║
║  │                                                      │ ║
║  └──────────────────────────────────────────────────────┘ ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝
```

---

## 🎬 第 11 步：插入初始数据

**操作：** 添加初始数据行

**你会看到：**

```
╔════════════════════════════════════════════════════════════╗
║                                                            ║
║  party_data                                                ║
║                                                            ║
║  ┌──────────────────────────────────────────────────────┐ ║
║  │                                                      │ ║
║  │  [Insert row]                                       │ ║
║  │                                                      │ ║
║  │  id    | data | updated_at                          │ ║
║  │  ────────────────────────────────────────────────   │ ║
║  │  (空的)                                              │ ║
║  │                                                      │ ║
║  └──────────────────────────────────────────────────────┘ ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝
```

**操作步骤：**

1. 点击 **"Insert row"**
2. 在 `id` 字段输入：`main`
3. 在 `data` 字段点击，会打开 JSON 编辑器
4. 粘贴以下 JSON：

```json
{
  "foodies": [],
  "drinkers": [],
  "gamePreferences": [],
  "vibeVotes": [],
  "krystalLikes": 0,
  "memberLikes": {},
  "memberComments": {},
  "customMembers": [],
  "gameLobbies": [],
  "visits": 0,
  "lastVisit": null,
  "visitHistory": []
}
```

5. 点击 **"Save"**

**完成后你会看到：**

```
╔════════════════════════════════════════════════════════════╗
║                                                            ║
║  party_data                                                ║
║                                                            ║
║  ┌──────────────────────────────────────────────────────┐ ║
║  │                                                      │ ║
║  │  id    | data              | updated_at             │ ║
║  │  ────────────────────────────────────────────────   │ ║
║  │  main  | {...}             | 2024-01-15 10:30:45   │ ║
║  │                                                      │ ║
║  └──────────────────────────────────────────────────────┘ ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝
```

---

## 🎯 第 12 步：获取 API 凭证

**操作：** 获取 Supabase API 凭证

**步骤：**

1. 点击左侧菜单的 **"Settings"**（齿轮图标）
2. 点击 **"API"** 标签
3. 你会看到：

```
╔════════════════════════════════════════════════════════════╗
║                                                            ║
║  API Settings                                              ║
║                                                            ║
║  ┌──────────────────────────────────────────────────────┐ ║
║  │                                                      │ ║
║  │  Project URL:                                       │ ║
║  │  https://abcdefghijklmnop.supabase.co  [📋 Copy]   │ ║
║  │                                                      │ ║
║  │  API Keys:                                          │ ║
║  │                                                      │ ║
║  │  anon (public):                                     │ ║
║  │  eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...  [📋]    │ ║
║  │                                                      │ ║
║  │  service_role (secret):                             │ ║
║  │  eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...  [📋]    │ ║
║  │                                                      │ ║
║  └──────────────────────────────────────────────────────┘ ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝
```

**操作步骤：**

1. 点击 Project URL 右边的 **[📋 Copy]** 按钮
2. 粘贴到记事本，保存为：
   ```
   SUPABASE_URL = https://abcdefghijklmnop.supabase.co
   ```

3. 点击 anon (public) 右边的 **[📋]** 按钮
4. 粘贴到记事本，保存为：
   ```
   SUPABASE_KEY = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
   ```

⚠️ **重要：保存这两个值！接下来会用到！**

---

## 🚀 第 13 步：配置 Render

**操作：** 在 Render 中添加环境变量

**步骤：**

1. 打开 https://dashboard.render.com
2. 找到你的后端服务（tianlai-backend）
3. 点击进入
4. 点击左侧菜单的 **"Environment"**

**你会看到：**

```
╔════════════════════════════════════════════════════════════╗
║                                                            ║
║  Environment                                               ║
║                                                            ║
║  ┌──────────────────────────────────────────────────────┐ ║
║  │                                                      │ ║
║  │  Environment Variables:                             │ ║
║  │                                                      │ ║
║  │  [Add Environment Variable]                         │ ║
║  │                                                      │ ║
║  └──────────────────────────────────────────────────────┘ ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝
```

**添加第一个变量：**

1. 点击 **"Add Environment Variable"**
2. 填写：
   - Key: `SUPABASE_URL`
   - Value: 粘贴你的 Project URL
3. 点击 **"Add"**

**添加第二个变量：**

1. 再次点击 **"Add Environment Variable"**
2. 填写：
   - Key: `SUPABASE_KEY`
   - Value: 粘贴你的 API Key
3. 点击 **"Add"**

**完成后你会看到：**

```
╔════════════════════════════════════════════════════════════╗
║                                                            ║
║  Environment Variables:                                    ║
║                                                            ║
║  ┌──────────────────────────────────────────────────────┐ ║
║  │                                                      │ ║
║  │  SUPABASE_URL = https://abcdefghijklmnop.supabase.co│ ║
║  │  SUPABASE_KEY = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9│ ║
║  │                                                      │ ║
║  │  ✅ Environment variables updated                   │ ║
║  │                                                      │ ║
║  └──────────────────────────────────────────────────────┘ ║
║                                                            ║
╚════════════════════════════════════════════════════════════╝
```

Render 会自动重新部署你的服务。等待 2-3 分钟。

---

## 💻 第 14 步：推送代码

**操作：** 在本地推送代码

**打开终端，运行：**

```bash
# 进入项目目录
cd /Users/tianlaizhang/Downloads/LOL

# 进入 backend 文件夹
cd backend

# 安装依赖
npm install

# 返回项目根目录
cd ..

# 提交代码
git add .
git commit -m "迁移到 Supabase 数据库"

# 推送到 GitHub
git push
```

**你会看到：**

```
Enumerating objects: 5, done.
Counting objects: 100% (5/5), done.
Delta compression using up to 8 threads
Compressing objects: 100% (3/3), done.
Writing objects: 100% (3/3), 456 bytes | 456.00 KiB/s, done.
Total 3 (delta 2), reused 0 (delta 0), reused pack 0 (delta 0)
remote: Resolving deltas: 100% (2/2), done.
To https://github.com/Tianlai1122/Tianlai-s-Birthday-Party.git
   abc1234..def5678  main -> main
```

✅ 推送成功！

---

## 📊 第 15 步：验证部署

**操作：** 检查 Render 日志

**步骤：**

1. 回到 Render Dashboard
2. 点击你的后端服务
3. 点击 **"Logs"** 标签
4. 等待 2-3 分钟看新日志

**成功的日志应该显示：**

```
2024-01-15 10:30:45 npm install
2024-01-15 10:31:20 npm start
2024-01-15 10:31:25 ✅ Supabase 连接成功！数据将持久化保存
2024-01-15 10:31:26 ✅ 从 Supabase 加载数据成功
2024-01-15 10:31:27 🎉 生日派对服务器已启动！
2024-01-15 10:31:27 API 服务: http://localhost:3000
2024-01-15 10:31:27 数据存储: Supabase (持久化)
```

✅ **如果看到这些，说明连接成功了！**

---

## 🎉 第 16 步：测试功能

**操作：** 测试你的网站

**步骤：**

1. 打开浏览器
2. 访问：https://tianlai-s-birthday-party.vercel.app
3. 测试功能：
   - 点赞 😍
   - 发送留言
   - 添加小馋猫
   - 创建游戏组局

4. 回到 Supabase Dashboard
5. 点击 Table Editor
6. 选择 `party_data` 表
7. 点击 `id = main` 的行
8. 查看 `data` 字段

**你应该能看到你刚才添加的数据！**

✅ **完成！**

---

## 🎊 恭喜！

你已经成功配置了 Supabase！

你的数据现在将永久保存在 Supabase 中！🚀

